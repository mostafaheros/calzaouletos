"use strict";(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[6121],{63968:function(e,i,t){t.r(i),t.d(i,{AUTH_RESULT_REASON:function(){return y.$9},BIEvents:function(){return A},INTERACTIONS:function(){return y.SE},PrivacyStatus:function(){return Ee.iY},PrivacyStatusStatus:function(){return D},Role:function(){return _},SiteMembersApiSymbol:function(){return f.n9},Status:function(){return I},isLoginAcceptableError:function(){return O.Y2},isSignupAcceptableError:function(){return O.fJ},memberDetailsFromDTO:function(){return O.Ky},page:function(){return xe},site:function(){return je}});var o=t(43757),a=t(61049),n=t(49574),s=t(5096),r=t(55048),l=t(10666),c=t(58629),u=t(26513),d=t(82627),g=t(94315),m=t(25954),p=t(8562),h=t(21511),v=t(56405),S=t(19238),b=t(87821),E=t(86305),C=t(99552),w=t(16684),y=t(95848),f=t(2811);class P{constructor(e,i,t,o,a){this.propsStore=e,this.structureApi=i,this.siteScrollBlocker=t,this.browserWindow=o,this.cyclicTabbing=a}async displayDialog(e,i,t,o={}){const a=async()=>{(0,p.yF)(this.browserWindow)||(this.activeElementBeforeShowDialog=this.browserWindow.document.activeElement);const o=(0,w.uniqueId)(f.rj);this.propsStore.update({[o]:Object.assign(Object.assign({},i),t)}),this.currentCompId&&this.cyclicTabbing.disableCyclicTabbing(this.currentCompId),this.cyclicTabbing.enableCyclicTabbing(o),await this.structureApi.addComponentToDynamicStructure(o,{componentType:e,components:[]}),this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId)),this.siteScrollBlocker.setSiteScrollingBlocked(!0,o),this.currentCompId=o},{shouldWaitForAppDidMount:n,registerToAppDidMount:s}=o;n&&s?s(a):await a()}hideDialog(){var e;this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId),this.cyclicTabbing.disableCyclicTabbing(this.currentCompId)),this.currentCompId=void 0,(0,p.yF)(this.browserWindow)||(null===(e=this.activeElementBeforeShowDialog)||void 0===e||e.focus(),this.activeElementBeforeShowDialog=null)}}var D,I,_;!function(e){e.UNKNOWN="UNKNOWN",e.PRIVATE="PRIVATE",e.PUBLIC="PUBLIC"}(D||(D={})),function(e){e.UNKNOWN="UNKNOWN",e.PENDING="PENDING",e.APPROVED="APPROVED",e.BLOCKED="BLOCKED",e.OFFLINE="OFFLINE"}(I||(I={})),function(e){e.UNDEFINED_ROLE="UNDEFINED_ROLE",e.MEMBER="MEMBER",e.OWNER="OWNER",e.CONTRIBUTOR="CONTRIBUTOR"}(_||(_={}));var O=t(43096),N=t(42473),T=t(86681);const A=({sessionManager:e,businessLogger:i,wixBiSession:t,viewMode:o,language:a})=>{const n=(i,n)=>({biToken:t.msId,context:i,ts:R(t),viewmode:o,visitor_id:e.getVisitorId(),site_member_id:e.getSiteMemberId(),vsi:t.viewerSessionId,site_settings_lng:a.siteLanguage,browser_lng:a.userLanguage,lng_mismatch:a.siteLanguage!==a.userLanguage,layout:n});return{loginOrSignUpDialogLoaded:(e,t="fullscreen")=>{i.logger.log(Object.assign({src:5,evid:658},n(e,t)),{endpoint:"site-members"})},closingDialog:(e,t="fullscreen")=>{i.logger.log(Object.assign({src:5,evid:602,form_type:"default"},n(e,t)),{endpoint:"site-members"})},emailAuthSubmitClicked:(e,t)=>{i.logger.log(Object.assign({src:5,evid:603,form_type:"default"},n(e,t)),{endpoint:"site-members"})},siteMembersFeatureLoaded:()=>{i.logger.log(Object.assign({src:5,evid:698},n()),{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:()=>{i.logger.log(Object.assign({src:5,evid:699},n()),{endpoint:"site-members"})},siteMembersEmailConfirmationNewMembersModalLoad:()=>{i.logger.log(Object.assign({src:5,evid:1809},n()),{endpoint:"site-members"})},siteMembersEmailConfirmationSendCodeClick:()=>{i.logger.log(Object.assign({src:5,evid:1810},n()),{endpoint:"site-members"})},siteMembersEmailConfirmationOnResendCodeClick:()=>{i.logger.log(Object.assign({src:5,evid:1811},n()),{endpoint:"site-members"})}}},R=e=>{const i=e.initialTimestamp||0;return Date.now()-i},L={isCloseable:!0,returnPages:!1};class k{constructor(e,i){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e,this.onReset=i,this.config=L}async openPopupPage(e,i){var t;const o=this.shouldRunCustomPopupCloseCallback;this.preventCustomPopupCloseCallback(),await(null===(t=this.popups)||void 0===t?void 0:t.open(e,(()=>{this.shouldRunCustomPopupCloseCallback&&(this.rejectAuthenticationRequest(),i&&i())}))),this.shouldRunCustomPopupCloseCallback=o}preventCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!1}allowCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!0}assignRequestAuthenticationRejection(e){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||e}assignRequestAuthenticationResolveInstance(e){this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}assignRequestAuthenticationPromise(e,i){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||i,this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}rejectAuthenticationRequest(){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationRejectInstance(y.$9.CANCELED),this.reset())}resolveAuthenticationRequest(e){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationResolveInstance(e),this.reset())}setConfig({isCloseable:e=!0,returnPages:i=!1}){this.config={isCloseable:e,returnPages:i}}reset(){var e;null===(e=this.onReset)||void 0===e||e.call(this),this.requestAuthenticationRejectInstance=void 0,this.requestAuthenticationResolveInstance=void 0,this.config=L}}var U,M,V,B,F,G,j=t(48511),x=t(26034),$={},W={memberPrivacySettings:"_memberPrivacySettings"},q={updatedDate:"google.protobuf.Timestamp"};function H(e){return(0,j.Kk)(Object.assign(e,{domainToMappings:{"editor.wixapps.net":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"api._api_base_domain_":[{srcPath:"/members/v1/privacy-settings",destPath:""}],"manage._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"editor._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"blocks._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"create.editorx":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"www.wixapis.com":[{srcPath:"/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],_:[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"www._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"*.dev.wix-code.com":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}]}}))}!function(e){e.UNKNOWN="UNKNOWN",e.VISIBLE_TO_MEMBERS_ONLY="VISIBLE_TO_MEMBERS_ONLY",e.VISIBLE_TO_ALL="VISIBLE_TO_ALL"}(U||(U={})),function(e){e.UNKNOWN="UNKNOWN",e.NO_ONE="NO_ONE",e.ANYONE="ANYONE"}(M||(M={})),function(e){e.UNKNOWN="UNKNOWN",e.ENABLED="ENABLED",e.DISABLED="DISABLED",e.PENDING="PENDING",e.DEMO="DEMO"}(V||(V={})),function(e){e.OTHER="OTHER",e.FROM_TEMPLATE="FROM_TEMPLATE",e.DUPLICATE_BY_SITE_TRANSFER="DUPLICATE_BY_SITE_TRANSFER",e.DUPLICATE="DUPLICATE",e.OLD_SITE_TRANSFER="OLD_SITE_TRANSFER",e.FLASH="FLASH"}(B||(B={})),function(e){e.UNKNOWN_NAMESPACE="UNKNOWN_NAMESPACE",e.WIX="WIX",e.SHOUT_OUT="SHOUT_OUT",e.ALBUMS="ALBUMS",e.WIX_STORES_TEST_DRIVE="WIX_STORES_TEST_DRIVE",e.HOTELS="HOTELS",e.CLUBS="CLUBS",e.ONBOARDING_DRAFT="ONBOARDING_DRAFT",e.DEV_SITE="DEV_SITE",e.LOGOS="LOGOS",e.VIDEO_MAKER="VIDEO_MAKER",e.PARTNER_DASHBOARD="PARTNER_DASHBOARD",e.DEV_CENTER_COMPANY="DEV_CENTER_COMPANY",e.HTML_DRAFT="HTML_DRAFT",e.SITELESS_BUSINESS="SITELESS_BUSINESS",e.CREATOR_ECONOMY="CREATOR_ECONOMY",e.DASHBOARD_FIRST="DASHBOARD_FIRST",e.ANYWHERE="ANYWHERE",e.HEADLESS="HEADLESS",e.ACCOUNT_MASTER_CMS="ACCOUNT_MASTER_CMS"}(F||(F={})),function(e){e.UNKNOWN="UNKNOWN",e.TRASH="TRASH",e.DELETED="DELETED",e.PENDING_PURGE="PENDING_PURGE"}(G||(G={}));const Y=e=>{var i,t;const o=null===(i=e.joinCommunityCheckedByDefault)||void 0===i||i,a=null!==(t=e.privacyNoteType)&&void 0!==t?t:"CHECKBOX";return o?a:"CHECKBOX"},K=e=>{var i;return"NOTE"===Y(e)||(null===(i=e.joinCommunityCheckedByDefault)||void 0===i||i)},J=async(e,i)=>{const{data:t}=await e.request(function(e){var i=(0,x.G)($,{}),t=i.toJSON,o=i.fromJSON,a=(0,x.G)(W,{_memberPrivacySettings:q}).fromJSON;function n(i){var o=i.host,n=t(e);return{entityFqdn:"wix.members.v1.member_privacy_settings",method:"GET",methodFqn:"com.wixpress.members.memberprivacysettings.MemberPrivacySettingsService.GetMemberPrivacySettings",url:H({protoPath:"/v1/privacy-settings",data:n,host:o}),params:(0,j.kI)(n),transformResponse:a}}return n.fromReq=o,n}({}),{signedInstance:i});return t.memberPrivacySettings},z={[I.APPROVED]:"ACTIVE",[I.PENDING]:"PENDING"},X=e=>{var i;return e&&null!==(i=z[e])&&void 0!==i?i:"APPLICANT"};var Q=t(52306),Z={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_commonListValue",mapValue:"_commonMapValue"},ee={value:"_commonCustomValue"},ie={value:"Map#_commonCustomValue"},te={value:"_customValue"},oe={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_listValue",mapValue:"_mapValue"},ae={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",identityProfile:"_identityProfile"},ne={customFields:"_customField"},se={value:"_customValue"},re={},le={identity:"_identity",additionalData:"Map#_customValue"},ce={},ue={value:"Map#_customValue"},de={identity:"_identity"},ge={profile:"_identityProfile"},me={identity:"_identity",additionalData:"Map#_commonCustomValue"};function pe(e){return(0,j.Kk)(Object.assign(e,{domainToMappings:{_:[{srcPath:"/_api/iam/authentication",destPath:""}],"users._base_domain_":[{srcPath:"/iam/wix/google",destPath:"/v1/sso/callback/root/0e6a50f5-b523-4e29-990d-f37fa2ffdd69"},{srcPath:"/authentication",destPath:""}],"www.wixapis.com":[{srcPath:"/_api/iam/authentication",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}],"manage._base_domain_":[{srcPath:"/_api/authentication",destPath:""}],"www._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}]}}))}function he(e){var i=(0,x.G)(de,{_customField:te,_customValue:oe,_identity:ae,_identityProfile:ne,_listValue:se,_mapValue:ue}),t=i.toJSON,o=i.fromJSON,a=(0,x.G)(le,{_customField:te,_customValue:oe,_identity:ae,_identityProfile:ne,_listValue:se,_mapValue:ue}).fromJSON;function n(i){var o=i.host,n=t(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.Register",url:pe({protoPath:"/v1/register",data:n,host:o}),data:n,transformResponse:a}}return n.fromReq=o,n}function ve(e){var i=(0,x.G)(re,{}),t=i.toJSON,o=i.fromJSON,a=(0,x.G)(le,{_customField:te,_customValue:oe,_identity:ae,_identityProfile:ne,_listValue:se,_mapValue:ue}).fromJSON;function n(i){var o=i.host,n=t(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.Login",url:pe({protoPath:"/v1/login",data:n,host:o}),data:n,transformResponse:a}}return n.fromReq=o,n}function Se(e){var i=(0,x.G)(ge,{_customField:te,_customValue:oe,_identityProfile:ne,_listValue:se,_mapValue:ue}),t=i.toJSON,o=i.fromJSON,a=(0,x.G)(me,{_commonCustomValue:Z,_commonListValue:ee,_commonMapValue:ie,_customField:te,_customValue:oe,_identity:ae,_identityProfile:ne,_listValue:se,_mapValue:ue}).fromJSON;function n(i){var o=i.host,n=t(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.RegisterV2",url:pe({protoPath:"/v2/register",data:n,host:o}),data:n,transformResponse:a}}return n.fromReq=o,n}function be(e){var i=(0,x.G)(ce,{}),t=i.toJSON,o=i.fromJSON,a=(0,x.G)(me,{_commonCustomValue:Z,_commonListValue:ee,_commonMapValue:ie,_customField:te,_customValue:oe,_identity:ae,_identityProfile:ne,_listValue:se,_mapValue:ue}).fromJSON;function n(i){var o=i.host,n=t(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.LoginV2",url:pe({protoPath:"/v2/login",data:n,host:o}),data:n,transformResponse:a}}return n.fromReq=o,n}he.__isAmbassador=!0,ve.__isAmbassador=!0,Se.__isAmbassador=!0,be.__isAmbassador=!0;var Ee=t(74880),Ce={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_commonListValue",mapValue:"_commonMapValue"},we={value:"_commonCustomValue"},ye={value:"Map#_commonCustomValue"},fe={value:"_customValue"},Pe={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_listValue",mapValue:"_mapValue"},De={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",identityProfile:"_identityProfile"},Ie={customFields:"_customField"},_e={value:"_customValue"},Oe={value:"Map#_customValue"},Ne={identity:"_identity",additionalData:"Map#_commonCustomValue"},Te={};function Ae(e){return(0,j.Kk)(Object.assign(e,{domainToMappings:{"www.wixapis.com":[{srcPath:"/_api/iam/verification",destPath:""}],_:[{srcPath:"/_api/iam/verification",destPath:""}]}}))}function Re(e){var i=(0,x.G)(Te,{}),t=i.toJSON,o=i.fromJSON,a=(0,x.G)(Ne,{_commonCustomValue:Ce,_commonListValue:we,_commonMapValue:ye,_customField:fe,_customValue:Pe,_identity:De,_identityProfile:Ie,_listValue:_e,_mapValue:Oe}).fromJSON;function n(i){var o=i.host,n=t(e);return{entityFqdn:"wix.iam.verification.v1.start_response",method:"POST",methodFqn:"wix.iam.verification.v1.VerificationService.VerifyDuringAuthentication",url:Ae({protoPath:"/v1/auth/verify",data:n,host:o}),data:n,transformResponse:a}}return n.fromReq=o,n}Re.__isAmbassador=!0;const Le=(e,i,t)=>{document.cookie=`${e}=;max-age=0`,document.cookie=`${e}=;max-age=0;path=${i}`,document.cookie=`${e}=;domain=${t};max-age=0`,document.cookie=`${e}=;domain=${t};max-age=0;path=${i}`},ke=(0,o.ff)([(0,o.t6)(a.R9,f.u2),(0,o.t6)(a.jC,f.u2),(0,o.t6)(a.Wf,f.u2),(0,o.t6)(a.z8,f.u2),n.U,s.EE,s.Zr,v.Xb,r.xP,r.QZ,s.bk,s.ZQ,S.F0,(0,o.jt)(b.x),S.Iz,l.$,c.sK,(0,o.jt)(E.cC),(0,o.jt)(C.I),u.jj,d.O,(0,o.jt)(g.C),(0,o.jt)(T.a),(0,o.jt)(N.I)],((e,i,t,o,a,n,s,r,l,c,u,d,g,v,S,b,E,C,f={trackEvent:()=>0},D,I,N,T,R)=>{var L,U,V,B;const F=(0,m.O)(),{loginSocialBarOnSite:G,collectionExposure:j,protectedHomepage:x,smSessionCookie:$,memberInfoAppId:W,smcollectionId:q,isTemplate:H}=e;let{sm_efCookie:z}=e;const Z="WixInternal"===j,ee="22bef345-3c5b-4c18-b782-74d4085112ff",ie=r.getUserSession();let te=r.getAppInstanceByAppDefId(ee);const oe=()=>(0,O.OP)(r),{smSettings:ae,tpaApplicationIds:ne,policyLinks:se,translations:re}=i,le=W&&ne[W],{metaSiteId:ce,externalBaseUrl:ue,siteId:de,siteRevision:ge}=s.site,me=s.requestUrl,pe=s.viewMode,Ce=null!==(U=null===(L=s.anywhereConfig)||void 0===L?void 0:L.siteId)&&void 0!==U?U:de,we=null!==(B=null===(V=s.anywhereConfig)||void 0===V?void 0:V.revision)&&void 0!==B?B:ge,ye=-1!==y.F0.findIndex((e=>{var i,t;return null===(t=null===(i=null==d?void 0:d.navigator)||void 0===i?void 0:i.userAgent)||void 0===t?void 0:t.includes(e)})),fe=!ye,Pe=!ye,De=`/_api/wix-sm-webapp/tokens/verify/${ce}/${Ce}`,Ie=`${ue.replace(/\/$/,"")}/api/wix-sm/v1/authorize/${Ce}/pages`,_e=`/_api/wix-sm-webapp/tokens/logout/${ce}`,Oe=`/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId=${ce}&collectionId=${q}`,Ne=`/_api/wix-sm-webapp/social/token/handle?metaSiteId=${ce}&collectionId=${q}`,Te=ae.smFirstDialogLogin?"login":"signup",{socialLoginFacebookEnabled:Ae,socialLoginGoogleEnabled:ke,termsOfUse:Ue,privacyPolicy:Me,codeOfConduct:Ve,customSignUpPageId:Be,customSignInPageId:Fe}=ae,{privacyNoteType:Ge,joinCommunityCheckedByDefault:je}=((e,i)=>{var t;return i["specs.thunderbolt.enableSignUpPrivacyNoteType"]?{privacyNoteType:Y(e),joinCommunityCheckedByDefault:K(e)}:{privacyNoteType:"CHECKBOX",joinCommunityCheckedByDefault:null===(t=e.joinCommunityCheckedByDefault)||void 0===t||t}})(ae,I);let{smToken:xe}=e,$e={},We=$,qe=null,He=!1;const Ye=e=>{qe=e},Ke=()=>({registerToAppDidMount:Ye,shouldWaitForAppDidMount:!He}),Je=async()=>{var e;if(I["specs.thunderbolt.getMemberDetailsFromMembersNg"]){const{member:i}=await ei("/_api/members/v1/members/my?fieldsets=FULL",{headers:{authorization:null!==(e=r.getAppInstanceByAppDefId(ee))&&void 0!==e?e:""}}),{role:t}=await(0,O.Xh)((()=>{var e;return ei(`/api/wix-sm/v1/members/${null==i?void 0:i.id}/role`,{headers:{authorization:null!==(e=r.getAppInstanceByAppDefId(ee))&&void 0!==e?e:""}})}),(()=>({role:_.MEMBER})));return(({member:e,role:i})=>{var t,o,a,n,s,r,l,c,u,d,g,m,p,h,v,S,b,E,C,w,y;return{id:null!==(t=null==e?void 0:e.id)&&void 0!==t?t:"",contactId:null!==(o=null==e?void 0:e.contactId)&&void 0!==o?o:"",loginEmail:null!==(a=null==e?void 0:e.loginEmail)&&void 0!==a?a:"",imageUrl:null!==(r=null===(s=null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.photo)||void 0===s?void 0:s.url)&&void 0!==r?r:"",nickname:null!==(c=null===(l=null==e?void 0:e.profile)||void 0===l?void 0:l.nickname)&&void 0!==c?c:"",profilePrivacyStatus:null!==(u=null==e?void 0:e.privacyStatus)&&void 0!==u?u:"",slug:null!==(g=null===(d=null==e?void 0:e.profile)||void 0===d?void 0:d.slug)&&void 0!==g?g:"",status:X(null==e?void 0:e.status),creationDate:null!==(m=null==e?void 0:e.createdDate)&&void 0!==m?m:"",lastUpdateDate:null!==(p=null==e?void 0:e.updatedDate)&&void 0!==p?p:"",lastLoginDate:null!==(h=null==e?void 0:e.lastLoginDate)&&void 0!==h?h:"",emailVerified:null!==(v=null==e?void 0:e.loginEmailVerified)&&void 0!==v&&v,role:null!=i?i:"MEMBER",owner:i===_.OWNER,firstName:null!==(b=null===(S=null==e?void 0:e.contact)||void 0===S?void 0:S.firstName)&&void 0!==b?b:"",lastName:null!==(C=null===(E=null==e?void 0:e.contact)||void 0===E?void 0:E.lastName)&&void 0!==C?C:"",memberName:`${null===(w=null==e?void 0:e.contact)||void 0===w?void 0:w.firstName} ${null===(y=null==e?void 0:e.contact)||void 0===y?void 0:y.lastName}`,groups:void 0,emails:void 0,phones:void 0,addresses:void 0,labels:void 0,customFields:void 0}})({member:i,role:t})}const i=`/_api/wix-sm-webapp/member/${xe}?collectionId=${q}&metaSiteId=${ce}`,{payload:t}=await ei(i);return(0,O.Ky)(t)},ze={},Xe={},Qe=A({sessionManager:r,businessLogger:b,wixBiSession:E,viewMode:null==pe?void 0:pe.toUpperCase(),language:u});Qe.siteMembersFeatureLoaded();const Ze={},ei=(0,O.Qn)(a,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":`${we}`,"x-wix-client-artifact-id":"thunderbolt"}},me),ii=(0,Q.d)({isSSR:!1}),ti=((e,i)=>{let t;return{canHavePublicMembers:async()=>t||(t=new Promise((async t=>{const o=await J(e,i());t((null==o?void 0:o.publicMemberCandidates)===M.ANYONE)})),t)}})(ii,(()=>null!=te?te:"")),oi=((e,i,t)=>{const{isCommunityInstalled:o}=i;return{canHavePublicCommunity:async()=>t["specs.thunderbolt.shouldUseMemberPrivacySettingsService"]?e.canHavePublicMembers():o}})(ti,e,I),ai=((e,i,t,o,a)=>new P(e,i,t,o,a))(l,c,v,d,T),ni=new URL(me).searchParams.get("clientId"),si=((e,i,t,o,a,n)=>{let s,r;const l="/_serverless/collection-settings-facade/get-settings",c=async()=>r||e(n?`${l}?clientId=${n}`:l,{headers:{"Content-Type":"application/json",authorization:a||""}}).then((e=>(r=e,r))),u=async()=>o["specs.thunderbolt.useIAMEnabledConnections"]?c().then((e=>e.collectionSettings)):s||e("/_api/wix-sm-webapp/v1/collection/settings",{headers:{"Content-Type":"application/json",authorization:a||""}}).then((e=>e.settings)).then((e=>(s=e,e)));return{getSiteMembersSettings:u,getCaptchaSettings:()=>u().then(O.B_).catch((e=>(i.captureError(e,{tags:{feature:"site-members"}}),t.trackEvent((0,y.RN)(y.eE.ACTIONS.SETTINGS.FAIL)),{invisible:{login:!1,signup:!1},visible:{login:!1,signup:!0}}))),getEnabledConnections:()=>c().then((e=>{var i;return null!==(i=e.enabledConnections)&&void 0!==i?i:[]})),getLoginRedirectUrl:()=>c().then((e=>e.loginUrl))}})(ei,n,f,I,te,ni||void 0),ri=(0,O.eL)(d),li=(0,O.kY)(d,F),ci=new k(C,(async()=>{const e=await si.getCaptchaSettings();(e.invisible.login||e.invisible.signup)&&li.hideCaptchaBadge()})),ui=null==R?void 0:R.getBsi(),di=ui?ui.split("|")[0]:"00000000-0000-0000-0000-000000000000",gi=e=>{n.interactionStarted(y.SE.SOCIAL_APP_LOGIN_WITH_VENDOR(e))},mi={appDidMount(){qe&&qe(),He=!0},async login(e,i,t,o=!1,a,n=!1,s){var r,l,c,u,d,g,m,p,h,v,S;try{if(I["specs.thunderbolt.useNewRegisterLogin"])return mi.newLogin(e,i,t,o,a,n,s);const r=await si.getCaptchaSettings();if(r.visible.login&&!(null==t?void 0:t.recaptchaToken)&&!(null==a?void 0:a.otp)&&!(null==a?void 0:a.verificationId))throw y.Xu;f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.SUBMIT));const l=await mi.performLogin(e,i,n,r,t,a),c=await mi.handleLoginResponse(l,o);return f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.SUCCESS)),c}catch(a){if((0,O.Y2)(a)||f.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),(null===(l=null===(r=null==a?void 0:a.details)||void 0===r?void 0:r.applicationError)||void 0===l?void 0:l.code)===y.O1.WAITING_APPROVAL&&mi.showAdminApprovalDialog(e),(0,O.yQ)(a)){const r=null===(d=null===(u=null===(c=null==a?void 0:a.details)||void 0===c?void 0:c.applicationError)||void 0===u?void 0:u.data)||void 0===d?void 0:d.verificationId,l=null!==(h=null===(p=null===(m=null===(g=null==a?void 0:a.details)||void 0===g?void 0:g.applicationError)||void 0===m?void 0:m.data)||void 0===p?void 0:p.verificationFailureReason)&&void 0!==h?h:null===(S=null===(v=null==a?void 0:a.details)||void 0===v?void 0:v.applicationError)||void 0===S?void 0:S.code,b={email:e,verificationId:r,error:l};return mi.showVerificationCodeDialog(b).then((a=>{const r={verificationId:null==b?void 0:b.verificationId,otp:a};return mi.login(e,i,t,o,r,n,s).catch((e=>{throw n&&mi.showLoginDialog(s,e),e}))})).then((e=>(ai.hideDialog(),e)))}throw a}},async performLogin(e,i,t,o,a,n){var s;const r=null==C?void 0:C.getCurrentLightboxId(),l=null===(s=D.getCurrentRouteInfo())||void 0===s?void 0:s.pageId,c=t||Fe&&r&&Fe===r||Fe&&l&&Fe===l,u=o.invisible.login&&c?await ri(y.Ly.LOGIN):void 0;return(0,O.gb)(!!I["specs.thunderbolt.useIAMPlatform"],(async()=>{var t,o;const n=[];(null==a?void 0:a.recaptchaToken)&&n.push({Recaptcha:null==a?void 0:a.recaptchaToken}),u&&n.push({InvisibleRecaptcha:u});const s={identifier:{email:e},inputs:{password:i},captcha_tokens:n},r=I["specs.thunderbolt.iamOverAmbassador"]?await ii.request(ve(s),{signedInstance:te||""}).then((e=>e.data)):await ei("/_api/iam/authentication/v1/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:te||""},body:JSON.stringify(s)});return{member:(0,O.T2)(r),token:r.sessionToken,pages:(0,O.AC)(null===(t=r.additionalData)||void 0===t?void 0:t.protectedPages),status:null===(o=null==r?void 0:r.state)||void 0===o?void 0:o.status}}),(async()=>{var t;const o=await ei("/_api/wix-sm-webapp/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:te||""},body:JSON.stringify({email:e,password:i,recaptchaToken:null==a?void 0:a.recaptchaToken,invisibleRecaptchaToken:u,emailVerification:n})});return{member:o.member,token:null===(t=null==o?void 0:o.session)||void 0===t?void 0:t.token}}))},async handleOauthToken(e,i,t,o,a=!1){const s=r.getVisitorId();n.interactionStarted(y.SE.SOCIAL_APP_LOGIN),f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.SUBMIT,i));try{const{payload:r}=await ei(Ne,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svSession:ie,visitorId:s,token:e,provider:i,mode:t,lang:u.userLanguage,privacyStatus:o})});let l,c;n.interactionEnded(y.SE.SOCIAL_APP_LOGIN),n.interactionEnded(y.SE.SOCIAL_APP_LOGIN_WITH_VENDOR(i)),r.smSession&&(c=r.smSession.siteMemberDto,l=r.smSession.sessionToken),c=r.siteMemberDto;const g=(0,O.Ky)(c);(0,O.kS)(d,me,{});const m=await mi.handleLoginResponse({member:g,token:l},a);return f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.SUCCESS,i)),m}catch(e){throw f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.FAIL,i)),e}},async handleSocialLoginResponse(e,i,t=!1){var o;const a=null!==(o=y.KG[i])&&void 0!==o?o:i;n.interactionStarted(y.SE.SOCIAL_APP_LOGIN),n.interactionEnded(y.SE.SOCIAL_APP_LOGIN),n.interactionEnded(y.SE.SOCIAL_APP_LOGIN_WITH_VENDOR(a)),f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.SUBMIT,a));const s=(0,O.yL)(e);(0,O.kS)(d,me,{});const r=await mi.handleLoginResponse(s,t);return f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.SUCCESS,a)),r},async handleLoginResponse({token:e,member:i,pages:t,status:o},a=!1){const n=i.emailVerified;if(!e&&!n&&"ACTIVE"===i.status)return mi.showConfirmationEmailDialog(i.id);if(!e||"REQUIRE_OWNER_APPROVAL"===o)return mi.showAdminApprovalDialog(i.loginEmail);(0,O.kS)(d,me,{sessionToken:e});const s=await mi.applySessionToken(e,i,a&&!t,!!t),r=null!=t?t:s;return Object.assign({sessionToken:e,member:i},a?{pages:r}:{})},async promptLogin(e,i,t){var o,a,n,s;void 0===e&&(e={}),void 0===i&&(i=null===(a=null===(o=ci.config)||void 0===o?void 0:o.isCloseable)||void 0===a||a),void 0===t&&(t=null!==(s=null===(n=ci.config)||void 0===n?void 0:n.returnPages)&&void 0!==s&&s);const{mode:r,modal:l}=e,c="login"===(null!=r?r:Te),d=l?"popup":"fullscreen";return H?(await mi.showNotificationDialog(re.templateNotificationTitle,re.templateNotificationMessage,re.containerOk),Promise.reject(y.$9.CANCELED)):(li.loadScript(u.userLanguage,y.mz),c?mi.showLoginDialog({isCloseable:i,displayMode:d,returnPages:t}):mi.showSignUpDialog({isCloseable:i,displayMode:d,returnPages:t}))},promptForgotPassword(e=!0){return new Promise(((i,t)=>{ci.assignRequestAuthenticationPromise(i,t);const o={isCloseable:e,directionByLanguage:u.directionByLanguage,translations:re},a={async onCloseDialogCallback(){(0,O.CY)(me,d),Qe.closingDialog("RequestResetPassword"),ai.hideDialog(),ci.rejectAuthenticationRequest()},onSubmitCallback(e){return mi.sendForgotPasswordMail(e).then((async()=>{const e=()=>{(0,O.CY)(me,d),ci.resolveAuthenticationRequest(),t(y.$9.CANCELED)};mi.showNotificationDialog(re.resetPasswordCheckEmailTitle,re.resetPasswordCheckEmailText,re.resetPasswordOk,e,e)}))}},n=Ke();ai.displayDialog("RequestPasswordResetDialog",o,a,n)}))},async requestAuthentication(e={}){if(We)return{success:!0,token:We,reason:y.$9.ALREADY_LOGGED_IN};try{const i=!x,{sessionToken:t}=await mi.promptLogin(e,i);return{success:!0,token:t,reason:y.$9.SUCCESS}}catch(e){return{success:!1,reason:e}}},async requestAuthorizedPages(e={}){if(xe){return{success:!0,pages:await mi.authorizeMemberPagesBySignedInstance(xe)}}try{const i=!x;ci.setConfig({isCloseable:i,returnPages:!0});const t=await mi.promptLogin(e,i,!0);return ci.reset(),{success:!0,pages:t.pages}}catch(e){return{success:!1,reason:e}}},async applySessionToken(e,i,t=!1,a=!1){n.interactionStarted(y.SE.VERIFY_TOKEN);const s=await(a?ei(`/_api/iam/cookie/v1/createSessionCookie?sessionToken=${e}`,{method:"GET",headers:{authorization:te||""}}):ei(De,{method:"POST",body:`token=${e}`}));var l;if(n.interactionEnded(y.SE.VERIFY_TOKEN),await r.loadNewSession({reason:"memberLogin"}),te=r.getAppInstanceByAppDefId(ee),xe=r.getSmToken(),We=e,$e=null!=i?i:await mi.getMemberDetails(),await(l=$e,Promise.all(Object.entries(ze).map((async([e,i])=>{try{if("$$$timeout$$$"===await Promise.race([i(l),(0,O._v)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){n.captureError(e,{tags:{feature:"site-members"}})}})))),o.export({memberDetails:$e}),t)return s.payload.pages},async authorizeMemberPagesByCookie(){const e=(0,p.yF)(d)?{headers:{cookie:`smSession=${$}`}}:void 0,{authorizedPages:i}=await ei(Ie,e);return i},async authorizeMemberPagesByToken(e){if(e===$)return this.authorizeMemberPagesByCookie();const{payload:i}=await ei(De,{method:"POST",body:`token=${e}`}),{pages:t}=i;return t},async authorizeMemberPagesBySignedInstance(e){const i={headers:{authorization:e}},{authorizedPages:t}=await ei(Ie,i);return t},async getMemberDetails(e=!1){return $e.id&&!e?$e:xe?($e=await Je(),o.export({memberDetails:$e}),e&&await(i=$e,Promise.all(Object.values(Ze).map((async e=>{try{await e(i)}catch(e){n.captureError(e,{tags:{feature:"site-members"}})}})))),$e):null;var i},async register(e,i,t,o,a,s,r,l,c){var u,g,m,p,h,v,S,b,E,w;s=null!=s&&s;try{if(I["specs.thunderbolt.useNewRegisterLogin"])return mi.newRegister(e,i,t,o,a,s,r,l,c);const g=await si.getCaptchaSettings();if(g.visible.signup&&"Enabled"!==I["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&!r&&!(null==l?void 0:l.otp)&&!(null==l?void 0:l.verificationId))throw y.Xu;n.interactionStarted(y.SE.CODE_SIGNUP),f.trackEvent((0,y.RN)(y.eE.ACTIONS.SIGNUP.SUBMIT));const m=null==C?void 0:C.getCurrentLightboxId(),p=null===(u=D.getCurrentRouteInfo())||void 0===u?void 0:u.pageId,h=a||Be&&m&&Be===m||Be&&p&&Be===p,v=g.invisible.signup&&h?await ri(y.Ly.SIGNUP):void 0,{member:S,sessionToken:b,pages:E,status:w}=await mi.performRegister(e,i,{contactInfo:t,profilePrivacyStatus:o,isDefaultFlow:a,recaptchaToken:r,invisibleRecaptchaToken:v,emailVerification:l}),P=S.emailVerified,_="ACTIVE"===(null==S?void 0:S.status)?"ACTIVE":"PENDING";if(!b&&!P&&"ACTIVE"===S.status)return n.interactionEnded(y.SE.CODE_SIGNUP),mi.showConfirmationEmailDialog(S.id);if(a&&"APPLICANT"===(null==S?void 0:S.status)||!b||"REQUIRE_OWNER_APPROVAL"===w)return n.interactionEnded(y.SE.CODE_SIGNUP),mi.showAdminApprovalDialog(e);(0,O.kS)(d,me,{sessionToken:b});const N=await mi.applySessionToken(b,S,s&&!E,!!E),T=null!=E?E:N;return n.interactionEnded(y.SE.CODE_SIGNUP),f.trackEvent((0,y.RN)(y.eE.ACTIONS.SIGNUP.SUCCESS)),f.trackEvent({eventName:"CompleteRegistration",params:{origin:"Site members",method:"Wix"}}),Object.assign({member:S,status:_,sessionToken:b},s&&T?{pages:T}:{})}catch(l){if((0,O.yQ)(l)){const n=await si.getSiteMembersSettings(),u=null===(p=null===(m=null===(g=null==l?void 0:l.details)||void 0===g?void 0:g.applicationError)||void 0===m?void 0:m.data)||void 0===p?void 0:p.verificationId,d=null!==(b=null===(S=null===(v=null===(h=null==l?void 0:l.details)||void 0===h?void 0:h.applicationError)||void 0===v?void 0:v.data)||void 0===S?void 0:S.verificationFailureReason)&&void 0!==b?b:null===(w=null===(E=null==l?void 0:l.details)||void 0===E?void 0:E.applicationError)||void 0===w?void 0:w.code,C={email:e,verificationId:u,error:d};return mi.showVerificationCodeDialog(C).then((l=>{const u={verificationId:null==C?void 0:C.verificationId,otp:l};return"DURING_SIGNUP"!==n.emailVerificationOption?mi.login(e,i,{recaptchaToken:r},s,u,a).then((e=>{var i;const t="ACTIVE"===(null===(i=null==e?void 0:e.member)||void 0===i?void 0:i.status)?"ACTIVE":"PENDING";return Object.assign(Object.assign({},e),{status:t})}),(e=>{throw a&&mi.showLoginDialog(c,e),e})):mi.register(e,i,t,o,a,s,r,u,c).catch((e=>{throw a&&mi.showSignUpDialog(c,e),e}))})).then((e=>(ai.hideDialog(),e)))}throw(0,O.fJ)(l)?n.interactionEnded(y.SE.CODE_SIGNUP):f.trackEvent((0,y.RN)(y.eE.ACTIONS.SIGNUP.FAIL)),l}},async performRegister(e,i,{contactInfo:t,profilePrivacyStatus:o,isDefaultFlow:a,recaptchaToken:n,invisibleRecaptchaToken:s,emailVerification:r}={}){return(0,O.gb)(!!I["specs.thunderbolt.useIAMPlatform"],(async()=>{var a,r;const l={identity:{identifiers:[{email:e}],identityProfile:Object.assign(Object.assign({},(0,O.AO)(t||{})),{privacyStatus:o})},inputs:{password:i},captcha_tokens:[...n?[{Recaptcha:n}]:[],...s?[{InvisibleRecaptcha:s}]:[]]},c=I["specs.thunderbolt.iamOverAmbassador"]?await ii.request(he(l),{signedInstance:te||""}).then((e=>e.data)):await ei("/_api/iam/authentication/v1/register",{method:"POST",headers:{"Content-Type":"application/json",authorization:te||""},body:JSON.stringify(l)});return{member:(0,O.T2)(c),sessionToken:c.sessionToken,pages:(0,O.AC)(null===(a=c.additionalData)||void 0===a?void 0:a.protectedPages),status:null===(r=null==c?void 0:c.state)||void 0===r?void 0:r.status}}),(async()=>{const l={email:e,password:i,profilePrivacyStatus:o,contactInfo:(0,O.t1)(t||{}),defaultFlow:a,recaptchaToken:n,invisibleRecaptchaToken:s,emailVerification:r},{member:c,session:u}=await ei("/_api/wix-sm-webapp/v1/auth/signup",{method:"POST",headers:{"Content-Type":"application/json",authorization:te||""},body:JSON.stringify(l)});return{member:c,sessionToken:null==u?void 0:u.token}}))},async sendForgotPasswordMail(e){n.interactionStarted(y.SE.RESET_PASSWORD);const i=u.userLanguage,t=encodeURIComponent(me),o=encodeURIComponent(e),a=I["specs.thunderbolt.iamResetPasswordFlow"]?"/_api/iam/recovery/v1/send-email":"/_api/wix-sm-webapp/member/sendForgotPasswordMail",s=I["specs.thunderbolt.iamResetPasswordFlow"]?JSON.stringify({language:i,email:e,redirect:{url:me}}):`returnUrl=${t}&collectionId=${q}&metaSiteId=${ce}&lang=${i}&email=${o}`,r=I["specs.thunderbolt.iamResetPasswordFlow"]?{"Content-Type":"application/json",authorization:te||""}:void 0;await ei(a,{headers:r,method:"POST",body:s}),n.interactionEnded(y.SE.RESET_PASSWORD)},async sendSetPasswordEmail(e,i){const t=await ei("/_api/wix-sm-webapp/members/v1/auth/members/send-set-password-email",{method:"POST",headers:{"Content-Type":"application/json",authorization:te||""},body:JSON.stringify(Object.assign({email:e},(null==i?void 0:i.hideIgnoreMessage)?{hideIgnoreMessage:i.hideIgnoreMessage}:{}))});return!!(null==t?void 0:t.accepted)},async changePassword(e,i){const t=encodeURIComponent(e),o=i.startsWith(y.nc),a=o?"/_api/iam/recovery/v1/recover":Oe,n=o?JSON.stringify({password:e,recovery_token:i}):`newPassword=${t}&forgotPasswordToken=${i}`,s=o?{"Content-Type":"application/json",authorization:te||""}:void 0;await ei(a,{method:"POST",headers:s,body:n})},async resendEmailVerification(e){await ei(`/_api/wix-sm-webapp/tokens/email/resend/${e}`)},async logout(e){if(xe){if(await ei(_e,{method:"POST"}).catch((()=>{f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGOUT.FAIL))})),await Promise.all(Object.entries(Xe).map((async([e,i])=>{try{if("$$$timeout$$$"===await Promise.race([i(),(0,O._v)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){n.captureError(e,{tags:{feature:"site-members"}})}}))),e){const i=`./${e.replace(/^\//,"")}`;await g.navigate(i)}(0,p.yF)(d)||d.document.location.reload()}},registerToUserLogin(e,i=(0,w.uniqueId)("callback")){return ze[i]=e,i},unRegisterToUserLogin(e){delete ze[e]},registerToMemberLogout(e){const i=(0,w.uniqueId)("logout_callback");return Xe[i]=e,i},unRegisterToMemberLogout(e){delete Xe[e]},registerToMemberDetailsRefresh(e){const i=(0,w.uniqueId)("mdrcb");return Ze[i]=e,i},unRegisterToMemberDetailsRefresh(e){delete Ze[e]},async showWelcomeDialog(e=!0){const i={isCloseable:e,translations:re},t=S.getParsedUrl(),o={onCloseDialogCallback(){(0,O.CY)(me,d),Qe.closingDialog("WelcomeDialog");const e=new URL(me).hostname,i=0===e.indexOf("www")?e.substr(3):e;Le("sm_ef","/",i),z="",ai.hideDialog(),g.navigate(t.href)},onSubmitCallback(){const e=new URL(me).hostname,i=0===e.indexOf("www")?e.substr(3):e;Le("sm_ef","/",i),z="",ai.hideDialog(),le&&g.navigate("./account/my-account"),g.navigate(t.href)}};n.interactionStarted(y.SE.WELCOME_DIALOG),n.interactionEnded(y.SE.WELCOME_DIALOG),ai.displayDialog("WelcomeDialog",i,o)},async showNoPermissionsToPageDialog(e){const i={onCloseDialogCallback(){(0,O.CY)(me,d),ai.hideDialog(),e&&e()},onSwitchAccountLinkClick(){mi.logout()}};ai.displayDialog("NoPermissionsToPageDialog",{translations:re},i)},async showResetPasswordDialog(e){const i={isCloseable:!0,isTermsOfUseNeeded:!(!(null==Ue?void 0:Ue.enabled)||!se.termsOfUse),isPrivacyPolicyNeeded:!(!(null==Me?void 0:Me.enabled)||!se.privacyPolicy),termsOfUseLink:se.termsOfUse,privacyPolicyLink:se.privacyPolicy,directionByLanguage:u.directionByLanguage,translations:re},t=()=>{const e=S.getParsedUrl();return e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),S.pushUrlState(e),e},o={onCloseDialogCallback(){(0,O.CY)(me,d),Qe.closingDialog("ResetPasswordDialog");const e=t();ai.hideDialog(),g.navigate(e.href)},async onSubmitCallback(o){try{await mi.changePassword(o,e),mi.showNotificationDialog(re.resetPasswordSuccessTitle,"",re.containerOk,(async()=>{if(e.startsWith(y.nc)){const e=new URL(me).searchParams.get("redirectUrl");if(e)return null==d?void 0:d.location.replace(e)}const i=t();await mi.showLoginDialog(),g.navigate(i.href)}))}catch(e){const t=(0,O.zg)(e).toString();if(t!==y.O1.RESET_PASSWORD_TOKEN_EXPIRED&&t!==y.O1.NEW_RESET_PASSWORD_TOKEN_EXPIRED)throw e;mi.showNotificationDialog(re.passwordHasExpiredTitle,re.passwordHasExpiredText,re.passwordHasExpiredOk,(()=>mi.promptForgotPassword(i.isCloseable).then((()=>{const e=S.getParsedUrl();g.navigate(e.href)}))))}}};ai.displayDialog("ResetPasswordDialog",i,o,Ke())},async showLoggedInResetPasswordDialog(){const e={isCloseable:!0,directionByLanguage:u.directionByLanguage,translations:re},i={onCloseDialogCallback(){Qe.closingDialog("LoggedInResetPasswordDialog"),ai.hideDialog()},async onSubmitCallback(){}};ai.displayDialog("LoggedInResetPasswordDialog",e,i,Ke())},async showLoginDialog(e={},i){const{returnPages:t,isCloseable:o,displayMode:a}=Object.assign({isCloseable:!0,displayMode:"fullscreen",returnPages:!1},e),s=await si.getCaptchaSettings();return li.setCaptchaBadgeVisibility(s.invisible.login),Fe&&(null==C?void 0:C.isLightbox(Fe))?mi.showCustomAuthenticationDialog(Fe,t):new Promise((async(r,l)=>{ci.assignRequestAuthenticationPromise(r,l);const c="Enabled"===I["specs.ShouldForceCaptchaVerificationOnLoginSpec"]||s.visible.login,[g,m]=(0,w.partition)(await mi.getConnections(),{appDefId:y.Ld.PASSWORD}),p=await mi.getLoginUrl(),v={bsi:di,displayMode:a,language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:o,smCollectionId:q,svSession:ie,biVisitorId:oe(),metaSiteId:ce,isEmailLoginEnabled:g.length>0,idps:m,shouldForceCaptchaVerification:!s.invisible.login&&c,isSocialAuthSupported:fe,serverError:i,reportBi:b.reportBi,translations:re,externalBaseUrl:mi.getExternalBaseUrl(),loginUrl:p},S={onCloseDialogCallback(){(0,O.CY)(me,d),ai.hideDialog(),Qe.closingDialog("MemberLoginDialog",a),ci.rejectAuthenticationRequest()},submit(i,o,s){return n.interactionStarted(y.SE.DEFAULT_LOGIN),Qe.emailAuthSubmitClicked("MemberLoginDialog",a),mi.login(i,o,s,t,void 0,!0,e).then((e=>{n.interactionEnded(y.SE.DEFAULT_LOGIN),ai.hideDialog(),r(e)})).catch((e=>{throw(0,O.Y2)(e)&&n.interactionEnded(y.SE.DEFAULT_LOGIN),e}))},onForgetYourPasswordClick(){mi.promptForgotPassword(o)},onSwitchDialogLinkClick(){mi.showSignUpDialog({isCloseable:o,displayMode:a,returnPages:t}).then(r,(()=>{ci.rejectAuthenticationRequest()}))},async onTokenMessage(e,i,o=!1){let a;return await oi.canHavePublicCommunity()&&(a=o?"PUBLIC":"PRIVATE"),mi.handleOauthToken(e,i,"memberLoginDialog",a,t).then((e=>{ai.hideDialog(),r(e)}))},onBackendSocialLogin(e,i){return mi.handleSocialLoginResponse(e,i,t).then((e=>{ai.hideDialog(),r(e)}))},getHostReadyPayload:()=>({visitorId:oe(),svSession:ie}),openCaptcha:(0,h.yT)({captcha:N,userLanguage:u.userLanguage}),reportSocialAuthStarted:gi};Qe.loginOrSignUpDialogLoaded("MemberLoginDialog",a),await ai.displayDialog("MemberLoginDialog",v,S,Ke()),mi.closeCustomAuthenticationDialogs(!0)}))},async showSignUpDialog(e={},i){const{returnPages:t,isCloseable:o,displayMode:a}=Object.assign({isCloseable:!0,displayMode:"fullscreen",returnPages:!1},e),s=await si.getCaptchaSettings();if(li.setCaptchaBadgeVisibility(s.invisible.signup),Be&&(null==C?void 0:C.isLightbox(Be)))return mi.showCustomAuthenticationDialog(Be,t);const r="Enabled"!==I["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&"Enabled"===I["specs.ShouldForceCaptchaVerificationOnSignupSpec"];return new Promise((async(l,c)=>{const g=r||s.visible.signup&&"Enabled"!==I["specs.ShouldPassCaptchaVerificationOnSignupSpec"],[m,p]=(0,w.partition)(await mi.getConnections(),{appDefId:y.Ld.PASSWORD}),v=await mi.getLoginUrl();ci.assignRequestAuthenticationPromise(l,c);const S={bsi:di,displayMode:a,language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:o,smCollectionId:q,biVisitorId:oe(),svSession:ie,metaSiteId:ce,isSocialAuthSupported:fe,isEmailLoginEnabled:m.length>0,idps:p,isCommunityInstalled:await oi.canHavePublicCommunity(),privacyNoteType:Ge,joinCommunityCheckedByDefault:je,isTermsOfUseNeeded:!(!(null==Ue?void 0:Ue.enabled)||!se.termsOfUse),isPrivacyPolicyNeeded:!(!(null==Me?void 0:Me.enabled)||!se.privacyPolicy),isCodeOfConductNeeded:!(!(null==Ve?void 0:Ve.enabled)||!se.codeOfConduct),shouldForceCaptchaVerification:!s.invisible.signup&&g,termsOfUseLink:se.termsOfUse,privacyPolicyLink:se.privacyPolicy,codeOfConductLink:se.codeOfConduct,serverError:i,reportBi:b.reportBi,translations:re,externalBaseUrl:mi.getExternalBaseUrl(),loginUrl:v},E={onCloseDialogCallback(){(0,O.CY)(me,d),ai.hideDialog(),Qe.closingDialog("SignUpDialog",a),ci.rejectAuthenticationRequest()},async submit(i,o,s){let r;if(await oi.canHavePublicCommunity()){r=("boolean"==typeof s?s:s.isCommunityChecked)?Ee.iY.PUBLIC:Ee.iY.PRIVATE}const c="boolean"==typeof s||null==s?void 0:s.recaptchaToken;return n.interactionStarted(y.SE.DEFAULT_SIGNUP),Qe.emailAuthSubmitClicked("SignUpDialog",a),mi.register(i,o,void 0,r,!0,t,c,void 0,e).then((e=>{n.interactionEnded(y.SE.DEFAULT_SIGNUP);const{member:i,sessionToken:o,pages:a}=e;o&&(ai.hideDialog(),l(Object.assign({member:i,sessionToken:o},t?{pages:a}:{})))})).catch((e=>{throw(0,O.fJ)(e)&&n.interactionEnded(y.SE.DEFAULT_SIGNUP),e}))},onSwitchDialogLinkClick(){mi.showLoginDialog({isCloseable:o,displayMode:a,returnPages:t}).then(l,(()=>{ci.rejectAuthenticationRequest()}))},async onTokenMessage(e,i,o=!1){let a;return await oi.canHavePublicCommunity()&&(a=o?"PUBLIC":"PRIVATE"),mi.handleOauthToken(e,i,"memberLoginDialog",a,t).then((e=>{ai.hideDialog(),l(e)}))},onBackendSocialLogin(e,i){return mi.handleSocialLoginResponse(e,i,t).then((e=>{ai.hideDialog(),l(e)}))},getHostReadyPayload:()=>({visitorId:oe(),svSession:ie}),openCaptcha:(0,h.yT)({captcha:N,userLanguage:u.userLanguage}),reportSocialAuthStarted:gi};Qe.loginOrSignUpDialogLoaded("SignUpDialog",a),await ai.displayDialog("SignUpDialog",S,E,Ke()),mi.closeCustomAuthenticationDialogs(!0)}))},async hideAuthDialog(){console.warn("hideAuthDialog is not supported")},async showNotificationDialog(e,i,t,o=(()=>0),a=(()=>0)){const n={isCloseable:!0,title:e,description:i,okButtonText:t,translations:re},s={onCloseDialogCallback(){(0,O.CY)(me,d),Qe.closingDialog("NotificationDialog"),ai.hideDialog(),a()},onOkButtonClick(){ai.hideDialog(),o()}};await ai.displayDialog("NotificationDialog",n,s)},async showConfirmationEmailDialog(e,i=!0){return new Promise(((t,o)=>{const a={isCloseable:!0,isSignUp:i,translations:re},n={onCloseDialogCallback(){(0,O.CY)(me,d),Qe.closingDialog("ConfirmationEmailDialog"),ai.hideDialog(),ci.rejectAuthenticationRequest(),o(y.$9.CANCELED)},async onResendConfirmationEmail(){await mi.resendEmailVerification(e),await mi.showConfirmationEmailDialog(e,!1).catch(o)}};ai.displayDialog("ConfirmationEmailDialog",a,n)}))},async showAdminApprovalDialog(e){return new Promise(((i,t)=>{const o=()=>{(0,O.kS)(d,me,{error:O.nA.ACCESS_DENIED}),ci.rejectAuthenticationRequest(),t(y.$9.CANCELED)};mi.showNotificationDialog("",`${re.applySuccess1} ${re.applySuccess2}`.replace("{0}",e),re.containerOk,o,o)}))},async showCustomAuthenticationDialog(e,i=!1){if(!C)throw new Error("popup unavailable");return new Promise((async(t,o)=>{ci.assignRequestAuthenticationPromise(t,o);const a=mi.registerToUserLogin((async()=>{ci.resolveAuthenticationRequest(Object.assign({member:$e,sessionToken:We},i?{pages:await mi.authorizeMemberPagesBySignedInstance(xe)}:{})),mi.unRegisterToUserLogin(a),C.getCurrentLightboxId()===e&&C.close()}),"customAuthCbId");await ci.openPopupPage(e,(()=>{mi.unRegisterToUserLogin(a)})),ai.hideDialog()}))},async closeCustomAuthenticationDialogs(e=!1){const i=null==C?void 0:C.getCurrentLightboxId();i&&[Be,Fe].includes(i)&&(e&&ci.preventCustomPopupCloseCallback(),await C.close(),ci.allowCustomPopupCloseCallback())},getForgotPasswordToken(){return new URL((0,p.yF)(d)?me:d.location.href).searchParams.get("forgotPasswordToken")},shouldDisplayWelcomeDialog(){return z&&le},async showVerificationCodeDialog(e){return new Promise((async(i,t)=>{var o,a;n.interactionStarted(y.SE.VERIFICATION_CODE),Qe.siteMembersEmailConfirmationNewMembersModalLoad(),ci.assignRequestAuthenticationPromise(i,t);const s={language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:null===(a=null===(o=ci.config)||void 0===o?void 0:o.isCloseable)||void 0===a||a,displayMode:"customPopup",email:null==e?void 0:e.email,error:null==e?void 0:e.error,translations:re},r={onResendVerificationCodeEmail(){Qe.siteMembersEmailConfirmationOnResendCodeClick(),i(null)},onCloseDialogCallback(){Qe.closingDialog("VerificationCode"),(0,O.CY)(me,d),ai.hideDialog(),ci.rejectAuthenticationRequest(),t(y.$9.CANCELED)},onSubmitCallback(e){Qe.siteMembersEmailConfirmationSendCodeClick(),i(e)}};n.interactionEnded(y.SE.VERIFICATION_CODE),ai.displayDialog("VerificationCodeDialog",s,r)}))},async appWillMount(){G&&await mi.getMemberDetails();switch(new URL(s.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":mi.showLoginDialog();break;case"SignUpDialog":mi.showSignUpDialog();break;case"RequestPasswordResetDialog":mi.promptForgotPassword();break;case"ResetPasswordDialog":mi.showResetPasswordDialog("faketoken");break;case"LoggedInResetPasswordDialog":mi.showLoggedInResetPasswordDialog();break;case"WelcomeDialog":mi.showWelcomeDialog();break;case"NoPermissionsToPageDialog":mi.showNoPermissionsToPageDialog();break;case"NotificationDialog":mi.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":mi.showConfirmationEmailDialog("fakemember");break;case"VerificationCodeDialog":mi.showVerificationCodeDialog({email:"testEmail@test.com"})}},pageWillUnmount({pageId:e}){[Be,Fe].includes(e)||ai.hideDialog()},getSocialAuthComponentProps(){return(0,O.IO)({config:e,viewerModel:s,sessionManager:r,bsiManager:R,handleOauthToken:mi.handleOauthToken,handleSocialLoginResponse:mi.handleSocialLoginResponse,isSocialAuthSupported:Pe,captcha:N,userLanguage:u.userLanguage,reportBi:b.reportBi,reportSocialAuthStarted:gi,useNewSocialFlow:!!I["specs.thunderbolt.ShouldUseNewIAMSocialFlow"],translations:re})},async getConnections(){if(I["specs.thunderbolt.useIAMEnabledConnections"])return si.getEnabledConnections().then((e=>e.map((({id:e,appDefId:i,displayName:t})=>({id:e,appDefId:i,name:t})))));const e=new URL(me).searchParams.get("idpConnectionId");return[...Z?[]:[{id:y.Ld.PASSWORD,appDefId:y.Ld.PASSWORD,name:"Password"}],...ke?[{id:y.Ld.GOOGLE,appDefId:y.Ld.GOOGLE,name:"Google"}]:[],...Ae&&!Z?[{id:y.Ld.FACEBOOK,appDefId:y.Ld.FACEBOOK,name:"Facebook"}]:[],...e?[{id:e,appDefId:e,name:"SSO"}]:[]]},getLoginUrl(){if(ni&&I["specs.thunderbolt.shouldFetchLoginUrlByClientId"])return si.getLoginRedirectUrl()},getExternalBaseUrl(){return I["specs.thunderbolt.shouldUseExternalBaseUrl"]?ue:void 0},async newRegister(e,i,t,o,a,s,r,l,c){var u,g,m,p;s=null!=s&&s;try{const c=await si.getCaptchaSettings();if(c.visible.signup&&"Enabled"!==I["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&!r&&!(null==l?void 0:l.otp)&&!(null==l?void 0:l.verificationId))throw y.Xu;n.interactionStarted(y.SE.CODE_SIGNUP),f.trackEvent((0,y.RN)(y.eE.ACTIONS.SIGNUP.SUBMIT));const h=null==C?void 0:C.getCurrentLightboxId(),v=null===(u=D.getCurrentRouteInfo())||void 0===u?void 0:u.pageId,S=a||Be&&h&&Be===h||Be&&v&&Be===v,b=c.invisible.signup&&S?await ri(y.Ly.SIGNUP):void 0,E={profile:Object.assign(Object.assign({},(0,O.AO)(t||{})),{privacyStatus:o,emails:[e]}),loginId:{email:e},password:i,captchaTokens:[...r?[{Recaptcha:r}]:[],...b?[{InvisibleRecaptcha:b}]:[]]},w=await ii.request(Se(E),{signedInstance:te||""}).then((e=>e.data)),P=await mi.getStateMachine(w,e),_=null===(g=null==P?void 0:P.additionalData)||void 0===g?void 0:g.protectedPages,N=(0,O.AC)(_),T=(0,O.aB)(P);(0,O.kS)(d,me,{sessionToken:null==P?void 0:P.sessionToken});const A=await mi.applySessionToken(null==P?void 0:P.sessionToken,T,s&&!N,!0),R=null!=N?N:A;n.interactionEnded(y.SE.CODE_SIGNUP),f.trackEvent((0,y.RN)(y.eE.ACTIONS.SIGNUP.SUCCESS)),f.trackEvent({eventName:"CompleteRegistration",params:{origin:"Site members",method:"Wix"}});const L=null==P?void 0:P.sessionToken,k=null===(p=null===(m=null==P?void 0:P.identity)||void 0===m?void 0:m.status)||void 0===p?void 0:p.name;return Object.assign({member:T,status:k,sessionToken:L},s&&R?{pages:R}:{})}catch(e){if(a)throw mi.showSignUpDialog(c,e),e;throw(0,O.fJ)(e)?n.interactionEnded(y.SE.CODE_SIGNUP):f.trackEvent((0,y.RN)(y.eE.ACTIONS.SIGNUP.FAIL)),e}},async getStateMachine(e,i){const t=null==e?void 0:e.state;return n.interactionEnded(y.SE.CODE_SIGNUP),t===Ee.Yk.REQUIRE_OWNER_APPROVAL?(n.interactionEnded(y.SE.CODE_SIGNUP),mi.showAdminApprovalDialog(i)):t===Ee.Yk.REQUIRE_EMAIL_VERIFICATION?mi.verifyEmailVerification(i,null==e?void 0:e.stateToken).then((e=>mi.getStateMachine(e,i))):e},async verifyEmailVerification(e,i,t){var o,a,n;try{const o={stateToken:i||"",code:null!=t?t:await mi.showVerificationCodeDialog({email:e})};return(await ii.request(Re(o),{signedInstance:te||""})).data}catch(t){const s={email:e,verificationId:"",error:null!==(n=null===(a=null===(o=null==t?void 0:t.details)||void 0===o?void 0:o.applicationError)||void 0===a?void 0:a.code)&&void 0!==n?n:"BAD_CODE"};return await mi.showVerificationCodeDialog(s),mi.verifyEmailVerification(e,i)}},async newLogin(e,i,t,o=!1,a,n=!1,s){var r,l,c,u;try{const s=await si.getCaptchaSettings();if(s.visible.login&&!(null==t?void 0:t.recaptchaToken)&&!(null==a?void 0:a.otp)&&!(null==a?void 0:a.verificationId))throw y.Xu;f.trackEvent((0,y.RN)(y.eE.ACTIONS.LOGIN.SUBMIT));const c=null==C?void 0:C.getCurrentLightboxId(),u=null===(r=D.getCurrentRouteInfo())||void 0===r?void 0:r.pageId,g=n||Fe&&c&&Fe===c||Fe&&u&&Fe===u,m=s.invisible.login&&g?await ri(y.Ly.LOGIN):void 0,p=[];(null==t?void 0:t.recaptchaToken)&&p.push({Recaptcha:null==t?void 0:t.recaptchaToken}),m&&p.push({InvisibleRecaptcha:m});const h={loginId:{email:e},password:i,captcha_tokens:p},v=await ii.request(be(h),{signedInstance:te||""}).then((e=>e.data)),S=await mi.getStateMachine(v,e),b=null===(l=null==S?void 0:S.additionalData)||void 0===l?void 0:l.protectedPages,E=(0,O.AC)(b),w=(0,O.aB)(S);(0,O.kS)(d,me,{sessionToken:null==S?void 0:S.sessionToken});const P=await mi.applySessionToken(null==S?void 0:S.sessionToken,w,o&&!E,!0),I=null!=E?E:P,_=null==S?void 0:S.sessionToken;return Object.assign({sessionToken:_,member:w},o?{pages:I}:{})}catch(i){if(n)throw mi.showLoginDialog(s,i),i;throw(0,O.Y2)(i)||f.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),(null===(u=null===(c=null==i?void 0:i.details)||void 0===c?void 0:c.applicationError)||void 0===u?void 0:u.code)===y.O1.WAITING_APPROVAL&&mi.showAdminApprovalDialog(e),i}}};return o.export({promptLogin:mi.promptLogin,logout:mi.logout,memberDetails:$e}),t.update((()=>({shouldShowRenderingBlockingDialogs:()=>!(!mi.getForgotPasswordToken()&&!mi.shouldDisplayWelcomeDialog()),showRenderingBlockingDialogs:()=>{const e=mi.getForgotPasswordToken();return e?mi.showResetPasswordDialog(e):mi.shouldDisplayWelcomeDialog()?mi.showWelcomeDialog():void 0}}))),mi}));var Ue=t(59032),Me=t(95793),Ve=t(81600);const Be=(0,o.ff)([f.n9],(e=>({getTpaHandlers(){const i=async(i,t,o)=>{var a,n,s;const r=await e.getMemberDetails(!0);return r?(null===(a=o.appClientSpecMapData)||void 0===a?void 0:a.isWixTPA)?{attributes:{firstName:null!==(n=r.firstName)&&void 0!==n?n:"",lastName:null!==(s=r.lastName)&&void 0!==s?s:"",privacyStatus:r.profilePrivacyStatus},name:r.memberName,email:r.loginEmail,id:r.id,owner:r.owner,status:r.status}:{id:r.id,owner:r.owner,status:r.status}:null},t=async(i,t={})=>{var o,a;const{member:n}=await e.promptLogin({mode:t.mode,modal:t.modal});return{attributes:{firstName:null!==(o=n.firstName)&&void 0!==o?o:"",lastName:null!==(a=n.lastName)&&void 0!==a?a:"",privacyStatus:n.profilePrivacyStatus},name:n.memberName,email:n.loginEmail,id:n.id,owner:n.owner,status:n.status}};return{currentMember:i,smCurrentMember:i,logOutCurrentMember:(0,Ve.u)(["site"],((i,t)=>{e.logout(null==t?void 0:t.url)})),requestLogin:(0,Ve.u)(["site"],t),smRequestLogin:(0,Ve.u)(["site"],t)}}}))),Fe=(0,o.ff)([f.n9,(0,o.t6)(a.$e,f.u2),r.xP],((e,{componentIds:i},t)=>({name:"site-members-components",pageWillMount(){const o=i.reduce(((i,t)=>{const o=e.getSocialAuthComponentProps();return Object.assign(Object.assign({},i),{[t]:o})}),{});t.update(o)}}))),Ge=(0,o.ff)([(0,o.t6)(a.Wf,f.u2)],(e=>({handle:async i=>{const{shouldShowRenderingBlockingDialogs:t,showRenderingBlockingDialogs:o}=e.get();return t()?(o(),null):i}}))),je=e=>{e(f.n9,Ue.j.AppWillMountHandler,Ue.j.AppDidMountHandler).to(ke),e(S.BD.BlockingDialogs).to(Ge)},xe=e=>{e(Me.go).to(Be),e(Ue.j.PageWillMountHandler).to(Fe),e(Ue.j.PageWillUnmountHandler).to((0,o.ff)([f.n9],(e=>({pageWillUnmount(i){return e.pageWillUnmount(i)}}))))}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/group_8.4d6fc38e.chunk.min.js.map